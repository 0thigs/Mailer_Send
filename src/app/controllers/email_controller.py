import smtplib
import ssl
import os
from email.mime.multipart import MIMEMultipart
from email.mime.text import MIMEText
from email.mime.base import MIMEBase
from email import encoders

class EmailController:
    def send(self, payload: dict) -> None:
        """Send an email to somebody
        Args:
            payload (dict): data of the sender
            - 'email': Email of the sender
            - 'password': Password of the sender
            - 'subject': Subject of the email
            - 'body': Body of the email
            - 'attachment': File in attachment of the email
        """

        def adicionar_anexo(message, filename):
            with open(payload["attachment"], "rb") as attachment:  # NOME DO PDF
                part = MIMEBase("application", "octet-stream")
                part.set_payload(attachment.read())
            encoders.encode_base64(part)
            part.add_header(
                "Content-Disposition",
                f"attachment; filename= {filename}",
            )
            message.attach(part)

        emailsTeste = ["machinimavlogs@gmail.com", "gabrielsoliveira1606@gmail.com"]

        emails = ["teste123456banana@gmail.com",'tadeu.yoshida@55pro.com.br', 'contact@7comm.com.br', 'joao@avionics.com.br', 'srvp@abimaq.org.br', 'lmainardi@acaditi.com.br', 'vendas@acnisdobrasil.com.br', 'contato@adtechsd.com.br', 'douglas.ortlibas@aernnova.com', 'contato@aeroconcepts.com.br', 'dario.cristaldo@aerocris.ind.br', 'contato@aerojr.com', 'leonardo.andrade@aeromot.com.br', 'aeroriver.adm@gmail.com', 'fulvio.delicato@aerospacebrazilcertifications.com', 'alexandra.gioso@agglobal.com.br', 'david@papayacomunicacao.com.br', 'ags@agsholding.com', 'contato@aichico.com', 'contato@adb.ind.br', 'atendimento@aisys.com.br', 'comercial@akaer.com.br', 'nd@aliger.io', 'juliana@allteccomposites.com.br', 'brasil@altair.com', 'contato@altave.com.br', 'contato@alvalavanderia.com', 'pires.anacris@gmail.com', 'souza_anap@yahoo.com.br', 'natani@aortacomunicacao.com.br', 'contato@apimetrology.com', 'info@arable.com', 'vendas@arbonne.com.br', 'alberto.bordonaba@aritex-es.com', 'contato@arqmedes.com', 'comercial.sjc@arquivar.com', 'marcos.bernardes@atimetals.com', 'aerospace@ats4i.com.br', 'eduardo.leonetti@eati-avibras.com.br', 'contact@awsgroup.com.br', 'salesbrazil@axon-cable.com', 'contato@baikalsec.com', 'falecom@bestcode.com.br', 'contato@betel.aero', 'comercial@biosind.com.br', 'nondiaye@gmail.com', 'octavio@bizu.space', 'salesbrasil@blueskynetwork.com', 'felipe.mello@bmlaw.com', 'contato@bongoup.com.br', 'helder@bongoup.com.br', 'contato@brengtrein.com.br', 'cristiane.rabello@buenonetworks.com.br', 'calfer@calfer.com.br', 'asbrito@cdatec.com.br', 'contato@cemaden.gov.br', 'demetrius.alexandre@fundhas.org.br', 'carl@agrointeligencia.com.br', 'celia.faria@cgvale.com.br', 'comercial@ciatec.ind.br', 'cassia@cintrarh.com.br', 'contato@cis-erp.com.br', 'cite@cite.org.br', 'gilca@climatempo.com.br', 'jose.henrique@clp.org.br', 'info@clurb.net', 'cristine.menezes@cmgovernanca.com.br', 'daniela@courban.com.br', 'contato@compassnegociosdisruptivos.com.br', 'lucianon@projetosigo.com.br', 'compressorinteligente@gmail.com', 'comercial@compsis.com.br', 'roberto.bonesio@comutensili.it', 'renato@conectadigitalsolutions.com', 'david@agenziamkt.com.br', 'admconsensus4@gmail.com', 'cjefgv@cjefgv.com.br', 'carlosvinicius@companyprogress.com.br', 'comercial@csjsistemas.com.br', 'contato@cstglobal.com.br', 'contato@centrotreinamentos.com.br', 'contato@databot.digital', 'info@datalogix.com.br', 'clientes@deepesg.com', 'daniel.resemini@deltavengenharia.com', 'michel.amaral@designa.com.br', 'comercial@devmaker.com.br', 'lduarte@digicon.com.br', 'atendimento@softcake.com.br', 'vendas@dodesk.com.br', 'contact@domrock.ai', 'contato@drlicita.com', 'drmcro@drmicro.com.br', 'alexandre@dtacargo.com.br', 'wagner@dualsys.com.br', 'fernandes.laerte@e3metais.com.br', 'leticia@easy2tech.com.br', 'financeiro@electroimpact.com', 'jose.brancalion@embraer.com.br', 'embras@embras.net', 'rpadantas@gmail.com', 'pier@emoov.com.br', 'marcelo.essado@emsisti.com.br', 'endneves.ndt@gmail.com', 'michelle.feierabend@energytelecom.com.br', 'comercial@engtelco.com.br', 'contato@environmentals.com.br', 'vanderlei@edgeofspace.com.br', 'epsoft@epsoft.com.br', 'ccghizoni@equatorialsistemas.com.br', 'juliomoreira@equatorium.com.br', 'contato@ermatech.com.br', 'comercial@ejt.com.br', 'luiz@esss.co', 'contato@estrataxia.com.br', 'comercial@evereste.org.br', 'sergio@explorer.com.br', 'extremussurfaces@gmail.com', 'rubsney.nascimento@fabsolucoes.com.br', 'fabiodossantos77@hotmail.com', 'cia.sjcampos@fsantoantonio.edu.br', 'recanto.bemtevi@hotmail.com', 'everton.mota@fastworkps.com.br', 'secretaria.sjc@fatec.sp.gov.br', 'fernando.vidal@favedigital.com.br', 'nehemias@femtociencias.com.br', 'ferdnan@gamatecnivca.com.br', 'carrasco@fev.com', 'srafgvsp@fgv.br', 'fibraforte@fibraforte.com.br', 'dennis@fieldeyes.com.br', 'contato@findrs.com.br', 'comercial@finetornos.com.br', 'mail@fius.com.br', 'hamiltonfaria@fiscoexpert.com.br', 'mcarneiro@fitec.org.br', 'marcelo.col@flareConsultoria.com.br', 'contato@fleeting.com.br', 'contato@fontesol.com.br', 'caio@fornariadvogados.com.br', 'milani@fotosensores.com', 'juridico@gabrielasutti.com.br', 'galvanobras@galvanobras.com.br', 'admin@genesis-dataculture.com', 'contato@genobiomas.com', 'querosabermais@geoambiente.com.br', 'comercial@geopx.com.br', 'contato@gerenciapedidos.com.br', 'antonio.roberto@ggbearings.com', 'gabriel@gjacintho.com.br', 'contato@globaldrones.com.br', 'comercial@globousinagem.com.br', 'clovis@gmpmarcatto.com.br', 'juvenal@gomed.med.br', 'contato@goodmarket7.com.br', 'contato@graunaaerospace.com.br', 'greenneat@greenneat.eco.br', 'marcelo@serco.com.br', 'contato@gsw.com.br', 'leandro@gtadv.com.br', 'daniel.vital@harpiahealth.com', 'contato@hciinvest.com.br', 'contato@heavensystem.com.br', 'carlos.lebre@hexagon.com', 'felipe@saudehi.com', 'ricardo.galavoti@gmail.com', 'juliana.santos@hsbs.com.br', 'atendimento@hubse.com.br', 'contato@hecontrols.com.br', 'comercial@iacit.com.br', 'comercial@ica.ind.br', 'paulo@iconeleanConsultoria.com', 'comercial@id-subsea.com', 'thabata@ekoar.com.br', 'ieamar@unesp.br', 'luciana@ikedo.com.br', 'contato@imgautomacao.com.br', 'contato@imaxbrasil.com.br', 'imedical@imedicalproducts.com.br', 'sergio.santos@fatecguaratingueta.edu.br', 'elcioejo@innospc.com.br', 'contact@innovair.com.br', 'contato@innovecare.com.br', 'joselito.chagas@inovatioeducacao.com.br', 'carina@interagere.com', 'comercial@inventvision.com.br', 'contato@ionic.health', 'aizita.miller@gmail.com', 'lel@ipt.br', 'luciano.campos@iqa.org.br', 'comercial@irancho.com.br', 'contato@itfast.com.br', 'rotero@itaimsa.com.br', 'itakar@itakar.com.br', 'pmo.adm@itaventures.com.br', 'contato@ito1.com.br', 'contact@jandayasolutions.com', 'kelson@jetsoft.com.br', 'contato@kersys.com.br', 'knblabs@knblabs.com', 'federico@kontrate.me', 'contato@kukka.com.br', 'elcio@kvantum.com.br', 'diogo.barbosa@latecoere.aero', 'legadocircular@gmail.com', 'renato@legadousinagem.com.br', 'faleconosco@liax.com.br', 'info.lbr@liebherr.com', 'comercial@limabonfa.com.br', 'contact@loricomunica.com', 'contato@losconsultoria.com.br', 'contato@lsitec.org.br', 'mario@lucenadesign.com.br', 'info@lumesolutions.com', 'gustavo.tonioli@mtorres.com', 'comercial@meklogistics.com.br', 'maria@maia.solutions', 'anogueira@magroup.net', 'contato@aired.com', 'contato@massucato.com.br', 'ricardo.medina@consultingnow.com.br', 'contabilidade@mendesemartins.com.br', 'gilberto@metalinox.com.br', 'jandersononobrega@metinjo.com.br', 'negocios@metrobyte.com.br', 'comercial@mettabr.com', 'comercial@microassist.com.br', 'edilson@mikrostamp.com.br', 'comercial@missim.com.br', 'comercial@missim.com.br', 'alexandre.zaramella@acs-solutions.com.br', 'paulorocha@mrpsmartsolutions.com', 'k.manke@mtsbrasil.com.br', 'ivo@nadaiusinagem.com.br', 'falecom@nanoink.com.br', 'fgnicodemos@ncb.ind.br', 'contato@nectosystems.com.br', 'contact@neothingsiot.com', 'cit@br.nestle.com', 'adriano@next.tec.br', 'contato@nexusagroambiente.com.br', 'contato@nexusbr.com', 'f.quintanilha@nicksaude.com.br', 'contato@nm2.eco.br', 'ctrentini@nse-groupe.com', 'contato@o2eco.com.br', 'marketing@ocellott.com', 'contato@omega7systems.com', 'comercial@omnisys.com.br', 'mario@onetsistemas.com', 'msantos@onixengi.com', 'comercial@onset.com.br', 'atendimento@opensolutions.net.br', 'cloud@opensense.com.br', 'contato@e-opentech.com.br', 'info@optgis.com.br', 'dante@orbitlog.com', 'guto@orlandoseguros.com.br', 'projetos@ortosintese.com.br', 'vitor.torres@ottertechs.com', 'contato@paixmedical.com', 'gabriel@paledot.net', 'gabriel.faria@panmetal.com.br', 'Alfredo.zina@panairllc.com', 'thiago@panda3.com.br', 'tainara.guimaraes@panoramasi.com.br', 'falecom@parker.com', 'contato@pensa.eng.br', 'contato@phytorestore.com.br', 'dirco.junior@planifer.com.br', 'contato@plantemtech.com', 'plasteam@plasteam.com.br', 'paluma@plenavi.com.br', 'jose.verissimo@prevfacil.com', 'atendimento@prlme.com.br', 'comercial@promarking.com.br', 'bruno.silva@prochain.com.br', 'contato@proconcept.com.br', 'fabricio@phohauser.com.br', 'contato@proinvesttd.com.br', 'leandro@proxion.com.br', 'fmarques@raisingthebar.com.br', 'contato@rcomtelecom.com.br', 'reginaldo@realiconsorcios.com.br', 'jacques@recominte.com', 'laurenzi.vilela@redesaudefacil.com.br', 'samrachid@gmail.com', 'vendas@resix.com.br', 'comercial@ribfer.com.br', 'ride@ridetv.com.br', 'contato@rrunner.com.br', 'ewerton.ventura@robolabs.com.br', 'vendas@rdt.com.br', 'rosana.valim@assessoriarv.com.br', 'contato@voesafe.com.br', 'joao-paulo.ishida@safrangroup.com', 'contato@saipher.com.br', 'douglas.souza@sankhya.com.br', 'ssat@ssat.com.br', 'luiz.orlandini@schoolastic-app.com', 'contato@scivale.com.br', 'pizzi@sekodobrasil.com.br', 'contato@selfsolutions.com.br', 'faleconosco@sesisenaisp.org.br', 'luiz.souza@serpo-industrial.com', 'valeria@serraview.com.br', 'tatiana.lima@set-consultoria.com', 'gilberto.damasceno@shamal.com.br', 'siatt@siatt.com.br', 'sicoob@sicoobcosae.org.br', 'oliveira.guilherme@siemens.com', 'contato@siltecnologia.com.br', 'info@softgrippers.com', 'edvar@cps.softex.br', 'rodrigo.garbelotto@sonaca.com', 'jocanogueira@uol.com.br', 'j.souza@souzaraujo.com', 'info@soyuz.com.br', 'rafael.spadotto@spadottoadvogados.com.br', 'sales@speedbird.aero', 'andre.barra@squadengineer.com.br', 'comercial@squitter.com.br', 'contato@starone.one', 'sandrolugao@stbaero.com.br', 'tpgerardi@stefanini.com', 'contato@subiter.com', 'falecom@suellenferrari.com.br', 'jrfagundes.estagios@gmail.com', 'superclient@superclient.com.br', 'mauro.cordeiro2013@gmail.com', 'daniel.assad@tadtelmax.com', 'eduardopiloto@techal.com.br', 'vendas@techduto.com.br', 'mgusmao@tecnatom.com', 'joaohprado.sl@gmail.com', 'aerospace@tecplas.com.br', 'elielso.tecpro@yahoo.com', 'tecservice@tecservice.com.br', 'contato@tecterra.com.br', 'contato@tellinkengenharia.com.br', 'comercial@thalesgroup.com', 'info@thruone.com', 'fabio.cruz@thyssenkrupp.com', 'comercial@tinnova.com.br', 'contato@tovcafe.com.br', 'contato@trackcash.com.br', 'contato@trendz.com.br', 'contato@triasoftware.com.br', 'contatomagopool@gmail.com', 'mago@tropikaliabrands.com.br', 'contato@truelifeai.com', 'ubdent@ubdent.com.br', 'edutonini@uftmet.com.br', 'fabiana.fiore@unesp.br', 'felipe.ferreira@universalpainting.com.br', 'cite@cite.org.br', 'uprise.engineering1@gmail.com', 'urbam@urbam.com.br', 'compras@usicam.com.br', 'utec@utec.net.br', 'contato@valecloud.com.br', 'solucao@valesystem.net', 'contato@vanforfun.com.br', 'mauricio@vectratechnology.com.br', 'robson.galvao@vemax.ind.br', 'pedro.meneghetti@vilage.com.br', 'contato@visionaespacial.com.br', 'alexandre@vo2pro.com.br', 'voaline@voaline.com', 'rquindos@vsataerospace.com', 'nany@aweebusiness.com', 'comercial@wfestruturas.ind.br', 'ney@winnstal.com.br', 'renato.conte@wipro.com.br', 'tiago@xperiencexr.com', 'edaddio@youon.energy', 'comercial@youtan.com.br'] 


        # SALVA A LISTA DE EMAILS
        #with open("emails_list.py", "r") as arquivo:
        #    emails = arquivo.read()

        # LOOP QUE ENVIA OS EMAILS!
        for receiver_email in emails:  # trocar `emailsTeste` pela lista `emails`!
            message = MIMEMultipart()
            message["From"] = payload["email"]
            message["To"] = receiver_email
            message["Subject"] = payload["subject"]

            message.attach(MIMEText(payload["body"], "html"))

            # Adicionar anexo ao e-mail
            # filename = "curriculo.pdf"  # Nome do arquivo P DF a ser anexado
            adicionar_anexo(message, payload["attachment"])

            # Converter a mensagem para string
            text = message.as_string()

            # Login no servidor usando contexto seguro e envio de e-mail
            context = ssl.create_default_context()
            with smtplib.SMTP_SSL("smtp.gmail.com", 465, context=context) as server:
                server.login(payload["email"], payload["password"])
                server.sendmail(payload["email"], receiver_email, text)

        os.remove(payload["attachment"])
        print(payload)
        print("E-mails enviados com sucesso!")
